<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Technical Documentation - Crop Yield Prediction</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        /* Technical Page Specific Styles */
        :root {
            --code-bg: #1e1e2e;
            --code-text: #cdd6f4;
            --accent-blue: #89b4fa;
            --accent-green: #a6e3a1;
            --accent-yellow: #f9e2af;
            --accent-red: #f38ba8;
            --accent-purple: #cba6f7;
        }
        
        .tech-nav {
            position: sticky;
            top: 0;
            background: var(--card-background);
            padding: 15px 30px;
            box-shadow: var(--shadow-md);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tech-nav-links {
            display: flex;
            gap: 20px;
        }
        
        .tech-nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 6px;
            transition: var(--transition);
        }
        
        .tech-nav-links a:hover,
        .tech-nav-links a.active {
            background: var(--primary-color);
            color: white;
        }
        
        .tech-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .sidebar {
            position: sticky;
            top: 80px;
            height: fit-content;
            background: var(--card-background);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .sidebar h3 {
            font-size: 0.85rem;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 15px;
            letter-spacing: 1px;
        }
        
        .sidebar-nav {
            list-style: none;
        }
        
        .sidebar-nav li {
            margin-bottom: 8px;
        }
        
        .sidebar-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: var(--transition);
        }
        
        .sidebar-nav a:hover {
            background: #f0f0f0;
            border-left-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .content-area {
            background: var(--card-background);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-md);
        }
        
        .section {
            margin-bottom: 50px;
            padding-bottom: 40px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section h3 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin: 25px 0 15px;
        }
        
        .section p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            position: relative;
        }
        
        .code-block pre {
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .code-block code {
            color: var(--code-text);
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #313244;
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            margin: 20px 0 0;
        }
        
        .code-header span {
            color: var(--accent-blue);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        .code-header + .code-block {
            margin-top: 0;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
        }
        
        .copy-btn {
            background: var(--accent-purple);
            color: var(--code-bg);
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .copy-btn:hover {
            opacity: 0.8;
        }
        
        /* Tables */
        .tech-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95rem;
        }
        
        .tech-table th,
        .tech-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tech-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .tech-table tr:hover {
            background: #f8f9fa;
        }
        
        .tech-table code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        /* Metric Cards */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 25px;
            border-radius: var(--radius-md);
            text-align: center;
        }
        
        .metric-card.secondary {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
        }
        
        .metric-card.tertiary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Feature Importance Chart */
        .feature-bar {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .feature-name {
            width: 200px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .feature-bar-container {
            flex: 1;
            height: 24px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .feature-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .feature-value {
            width: 80px;
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        /* Algorithm Comparison */
        .algo-card {
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 15px;
            transition: var(--transition);
        }
        
        .algo-card:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
        }
        
        .algo-card.best {
            border-color: var(--success-color);
            background: rgba(76, 175, 80, 0.05);
        }
        
        .algo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .algo-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .algo-badge {
            background: var(--success-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .algo-metrics {
            display: flex;
            gap: 30px;
        }
        
        .algo-metric {
            text-align: center;
        }
        
        .algo-metric-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .algo-metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        /* Workflow Diagram */
        .workflow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 0;
            overflow-x: auto;
        }
        
        .workflow-step {
            text-align: center;
            min-width: 120px;
        }
        
        .workflow-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 10px;
        }
        
        .workflow-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .workflow-arrow {
            color: var(--border-color);
            font-size: 1.5rem;
        }
        
        /* API Endpoint */
        .endpoint {
            background: #f8f9fa;
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .endpoint-method {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .endpoint-method.get { background: #10b981; color: white; }
        .endpoint-method.post { background: #3b82f6; color: white; }
        
        .endpoint-path {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: var(--text-primary);
        }
        
        .endpoint-desc {
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .tech-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: relative;
                top: 0;
            }
            
            .workflow {
                flex-direction: column;
                gap: 20px;
            }
            
            .workflow-arrow {
                transform: rotate(90deg);
            }
        }
        
        /* Data Status Cards */
        .data-status-cards {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin: 25px 0;
        }
        
        .data-status-card {
            border-radius: var(--radius-md);
            padding: 25px;
            border: 2px solid;
        }
        
        .data-status-card.good {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.05), rgba(76, 175, 80, 0.1));
            border-color: #4caf50;
        }
        
        .data-status-card.partial {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.05), rgba(255, 193, 7, 0.1));
            border-color: #ffc107;
        }
        
        .data-status-card.contextual {
            background: linear-gradient(135deg, rgba(120, 144, 156, 0.05), rgba(120, 144, 156, 0.1));
            border-color: #78909c;
        }
        
        .status-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .status-header h4 {
            margin: 0;
            font-size: 1.2rem;
        }
        
        .status-icon {
            font-size: 1.5rem;
        }
        
        .data-status-card p {
            margin-bottom: 20px;
            color: var(--text-secondary);
        }
        
        .warning-box {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(255, 193, 7, 0.15);
            border-left: 4px solid #ffc107;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
        
        .info-box {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(33, 150, 243, 0.1);
            border-left: 4px solid #2196f3;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="tech-nav">
        <div class="logo">
            <span class="logo-icon">üåæ</span>
            <strong>Crop Yield Prediction</strong>
        </div>
        <div class="tech-nav-links">
            <a href="index.html">Dashboard</a>
            <a href="technical.html" class="active">Technical Docs</a>
            <a href="report.html">Quick View</a>
        </div>
    </nav>

    <div class="tech-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Contents</h3>
            <ul class="sidebar-nav">
                <li><a href="#overview">Project Overview</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#data-pipeline">Data Pipeline</a></li>
                <li><a href="#data-status">Data Field Status</a></li>
                <li><a href="#feature-engineering">Feature Engineering</a></li>
                <li><a href="#model-training">Model Training</a></li>
                <li><a href="#model-evaluation">Model Evaluation</a></li>
                <li><a href="#feature-importance">Feature Importance</a></li>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#deployment">Deployment</a></li>
                <li><a href="#code-samples">Code Samples</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="content-area">
            <!-- Overview Section -->
            <section id="overview" class="section">
                <h2>üìã Project Overview</h2>
                <p>
                    This project implements an end-to-end machine learning pipeline for predicting crop yield 
                    based on environmental, soil, and management factors. The system processes multiple heterogeneous 
                    datasets, performs feature engineering, trains multiple regression models, and serves predictions 
                    via a REST API.
                </p>
                
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">7,109</div>
                        <div class="metric-label">Total Samples</div>
                    </div>
                    <div class="metric-card secondary">
                        <div class="metric-value">12</div>
                        <div class="metric-label">Features Used</div>
                    </div>
                    <div class="metric-card tertiary">
                        <div class="metric-value">97.5%</div>
                        <div class="metric-label">R¬≤ Score</div>
                    </div>
                </div>
                
                <h3>Tech Stack</h3>
                <table class="tech-table">
                    <tr>
                        <th>Component</th>
                        <th>Technology</th>
                        <th>Version</th>
                    </tr>
                    <tr>
                        <td>Language</td>
                        <td><code>Python</code></td>
                        <td>3.11.9</td>
                    </tr>
                    <tr>
                        <td>Data Processing</td>
                        <td><code>pandas</code>, <code>numpy</code></td>
                        <td>2.3.x, 2.3.x</td>
                    </tr>
                    <tr>
                        <td>ML Framework</td>
                        <td><code>scikit-learn</code></td>
                        <td>1.5.x</td>
                    </tr>
                    <tr>
                        <td>Visualization</td>
                        <td><code>matplotlib</code>, <code>seaborn</code></td>
                        <td>3.9.x, 0.13.x</td>
                    </tr>
                    <tr>
                        <td>API Framework</td>
                        <td><code>Flask</code></td>
                        <td>3.1.x</td>
                    </tr>
                    <tr>
                        <td>Model Serialization</td>
                        <td><code>joblib</code></td>
                        <td>1.4.x</td>
                    </tr>
                </table>
            </section>

            <!-- Architecture Section -->
            <section id="architecture" class="section">
                <h2>üèóÔ∏è System Architecture</h2>
                <p>
                    The system follows a modular architecture with clear separation between data processing, 
                    model training, and serving layers.
                </p>
                
                <div class="workflow">
                    <div class="workflow-step">
                        <div class="workflow-icon">üìÅ</div>
                        <div class="workflow-label">Raw Data<br>(6 files)</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üîÑ</div>
                        <div class="workflow-label">ETL<br>Pipeline</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üßπ</div>
                        <div class="workflow-label">Feature<br>Engineering</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">ü§ñ</div>
                        <div class="workflow-label">Model<br>Training</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üöÄ</div>
                        <div class="workflow-label">REST<br>API</div>
                    </div>
                </div>
                
                <div class="code-header">
                    <span>project_structure.txt</span>
                </div>
                <div class="code-block">
                    <pre><code>Phase-2/
‚îú‚îÄ‚îÄ unified_dataset.csv      # Merged & cleaned dataset
‚îú‚îÄ‚îÄ full_workflow.py         # Complete ML pipeline
‚îÇ
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ model.pkl            # Trained GradientBoostingRegressor
‚îÇ   ‚îú‚îÄ‚îÄ scaler.pkl           # StandardScaler for normalization
‚îÇ   ‚îú‚îÄ‚îÄ imputer.pkl          # SimpleImputer for missing values
‚îÇ   ‚îú‚îÄ‚îÄ label_encoders.pkl   # Categorical encoders
‚îÇ   ‚îî‚îÄ‚îÄ feature_list.pkl     # Feature names for inference
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ app.py               # Flask REST API
‚îÇ
‚îî‚îÄ‚îÄ dashboard/
    ‚îú‚îÄ‚îÄ index.html           # User-facing prediction UI
    ‚îú‚îÄ‚îÄ technical.html       # This documentation
    ‚îî‚îÄ‚îÄ style.css, script.js</code></pre>
                </div>
            </section>

            <!-- Data Pipeline Section -->
            <section id="data-pipeline" class="section">
                <h2>üîÑ Data Pipeline</h2>
                <p>
                    The ETL pipeline consolidates 6 heterogeneous datasets into a unified schema. 
                    Each source dataset contributes different features to the final model.
                </p>
                
                <h3>Source Datasets</h3>
                <table class="tech-table">
                    <tr>
                        <th>Dataset</th>
                        <th>Records</th>
                        <th>Key Features</th>
                        <th>Target Variable</th>
                    </tr>
                    <tr>
                        <td><code>agricultural_yield_test.csv</code></td>
                        <td>4,000</td>
                        <td>Soil Quality, Seed Variety, Fertilizer, Irrigation</td>
                        <td>Yield_kg_per_hectare</td>
                    </tr>
                    <tr>
                        <td><code>Data.csv</code></td>
                        <td>8,914</td>
                        <td>Soil Humidity, Air Temp, Pressure, Wind</td>
                        <td>Crop Yield</td>
                    </tr>
                    <tr>
                        <td><code>indiancrop_dataset.csv</code></td>
                        <td>2,200</td>
                        <td>N/P/K, Temperature, Humidity, pH, State, Crop</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><code>crop yield data sheet.xlsx</code></td>
                        <td>109</td>
                        <td>Rainfall, Fertilizer, N/P/K</td>
                        <td>Yield (Q/acre)</td>
                    </tr>
                    <tr>
                        <td><code>data.xlsx</code></td>
                        <td>800</td>
                        <td>Moisture, Humidity, Soil Types</td>
                        <td>Millet Yield</td>
                    </tr>
                </table>
                
                <h3>Column Mapping Strategy</h3>
                <div class="code-header">
                    <span>column_mapping.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">COLUMN_MAPPING = {
    # Soil Nutrients
    'N_SOIL': 'Nitrogen',
    'P_SOIL': 'Phosphorus', 
    'K_SOIL': 'Potassium',
    'Nitrogen (N)': 'Nitrogen',
    
    # Temperature variations
    'TEMPERATURE': 'Temperature_C',
    'Air temperature (C)': 'Temperature_C',
    'Temperatue': 'Temperature_C',  # typo in source
    'Mean Temp': 'Temperature_C',
    
    # Humidity variations
    'HUMIDITY': 'Humidity',
    'Air humidity (%)': 'Humidity',
    'Average Humidity': 'Humidity',
    
    # Target variable mappings
    'Yield_kg_per_hectare': 'Yield_kg_per_hectare',
    'Crop Yield': 'Yield_kg_per_hectare',
    'Yeild (Q/acre)': 'Yield_kg_per_hectare',
    'millet yield': 'Yield_kg_per_hectare',
}</code></pre>
                </div>
            </section>

            <!-- Data Field Status Section -->
            <section id="data-status" class="section">
                <h2>üìä Data Field Status</h2>
                <p>
                    Understanding the quality and availability of training data for each feature is crucial 
                    for interpreting model predictions. Fields are categorized based on sample availability.
                </p>
                
                <h3>Data Quality Categories</h3>
                <div class="data-status-cards">
                    <div class="data-status-card good">
                        <div class="status-header">
                            <span class="status-icon">üü¢</span>
                            <h4>Good Data (3000+ samples)</h4>
                        </div>
                        <p>High confidence features with substantial training data</p>
                        <table class="tech-table">
                            <tr><th>Feature</th><th>Samples</th><th>Coverage</th></tr>
                            <tr><td><code>Rainfall_mm</code></td><td>7,099</td><td>99.9%</td></tr>
                            <tr><td><code>Temperature_C</code></td><td>3,099</td><td>43.6%</td></tr>
                            <tr><td><code>Humidity</code></td><td>3,000</td><td>42.2%</td></tr>
                            <tr><td><code>Sunshine_hours</code></td><td>4,000</td><td>56.3%</td></tr>
                            <tr><td><code>Soil_Quality</code></td><td>4,000</td><td>56.3%</td></tr>
                            <tr><td><code>Irrigation_Schedule</code></td><td>4,000</td><td>56.3%</td></tr>
                            <tr><td><code>Fertilizer_Amount_kg_per_hectare</code></td><td>4,099</td><td>57.7%</td></tr>
                            <tr><td><code>Seed_Variety</code></td><td>4,000</td><td>56.3%</td></tr>
                        </table>
                    </div>
                    
                    <div class="data-status-card partial">
                        <div class="status-header">
                            <span class="status-icon">üü°</span>
                            <h4>Partial Data (800-2300 samples)</h4>
                        </div>
                        <p>Features with limited data - values often imputed using median strategy</p>
                        <table class="tech-table">
                            <tr><th>Feature</th><th>Samples</th><th>Coverage</th><th>Note</th></tr>
                            <tr><td><code>Nitrogen</code></td><td>2,299</td><td>32.3%</td><td>Median imputed</td></tr>
                            <tr><td><code>Phosphorus</code></td><td>2,299</td><td>32.3%</td><td>Median imputed</td></tr>
                            <tr><td><code>Potassium</code></td><td>2,299</td><td>32.3%</td><td>Median imputed</td></tr>
                            <tr><td><code>Soil_Humidity</code></td><td>800</td><td>11.3%</td><td>Most imputed</td></tr>
                        </table>
                        <div class="warning-box">
                            ‚ö†Ô∏è <strong>Note:</strong> Predictions for these features may be less reliable 
                            when actual values differ significantly from imputed medians.
                        </div>
                    </div>
                    
                    <div class="data-status-card contextual">
                        <div class="status-header">
                            <span class="status-icon">‚ö™</span>
                            <h4>Contextual Only (No training data)</h4>
                        </div>
                        <p>Fields collected for display, recommendations, and future model improvements</p>
                        <table class="tech-table">
                            <tr><th>Field</th><th>Samples</th><th>Purpose</th></tr>
                            <tr><td><code>crop_type</code></td><td>2,200</td><td>Display & recommendations</td></tr>
                            <tr><td><code>state</code></td><td>2,200</td><td>Location-based tips</td></tr>
                            <tr><td><code>district</code></td><td>0</td><td>Future granular analysis</td></tr>
                            <tr><td><code>season</code></td><td>0</td><td>Seasonal patterns</td></tr>
                            <tr><td><code>farm_area</code></td><td>N/A</td><td>Total production calc</td></tr>
                            <tr><td><code>latitude/longitude</code></td><td>N/A</td><td>Geo-spatial features</td></tr>
                            <tr><td><code>sowing_date</code></td><td>0</td><td>Growing period calc</td></tr>
                        </table>
                        <div class="info-box">
                            ‚ÑπÔ∏è <strong>Future Enhancement:</strong> These fields will be incorporated into 
                            model training when sufficient labeled data is available.
                        </div>
                    </div>
                </div>
                
                <h3>Imputation Strategy</h3>
                <div class="code-header">
                    <span>imputation_strategy.py</span>
                </div>
                <div class="code-block">
                    <pre><code class="language-python"># SimpleImputer with median strategy
from sklearn.impute import SimpleImputer

imputer = SimpleImputer(strategy='median')
X_imputed = imputer.fit_transform(X_train)

# Features most affected by imputation:
# - Soil_Humidity: 88.7% imputed (only 800 real samples)
# - N/P/K nutrients: ~67.7% imputed</code></pre>
                </div>
            </section>

            <!-- Feature Engineering Section -->
            <section id="feature-engineering" class="section">
                <h2>‚öôÔ∏è Feature Engineering</h2>
                <p>
                    The final model uses 12 carefully selected features across weather, soil, and management categories.
                </p>
                
                <h3>Master Feature Schema</h3>
                <table class="tech-table">
                    <tr>
                        <th>Category</th>
                        <th>Feature</th>
                        <th>Type</th>
                        <th>Range</th>
                        <th>Preprocessing</th>
                    </tr>
                    <tr>
                        <td rowspan="4">üå§Ô∏è Weather</td>
                        <td><code>Rainfall_mm</code></td>
                        <td>float64</td>
                        <td>0 - 1300</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Temperature_C</code></td>
                        <td>float64</td>
                        <td>8 - 102</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Humidity</code></td>
                        <td>float64</td>
                        <td>10 - 100</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Sunshine_hours</code></td>
                        <td>float64</td>
                        <td>66 - 138</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td rowspan="5">üå± Soil</td>
                        <td><code>Soil_Quality</code></td>
                        <td>float64</td>
                        <td>50 - 100</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Soil_Humidity</code></td>
                        <td>float64</td>
                        <td>12.5 - 13.2</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Nitrogen</code></td>
                        <td>float64</td>
                        <td>0 - 140</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Phosphorus</code></td>
                        <td>float64</td>
                        <td>5 - 145</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Potassium</code></td>
                        <td>float64</td>
                        <td>5 - 205</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td rowspan="3">üöú Management</td>
                        <td><code>Fertilizer_Amount_kg_per_hectare</code></td>
                        <td>float64</td>
                        <td>50 - 300</td>
                        <td>Median imputation</td>
                    </tr>
                    <tr>
                        <td><code>Irrigation_Schedule</code></td>
                        <td>int64</td>
                        <td>0 - 10</td>
                        <td>LabelEncoder</td>
                    </tr>
                    <tr>
                        <td><code>Seed_Variety</code></td>
                        <td>int64</td>
                        <td>0 - 5</td>
                        <td>LabelEncoder</td>
                    </tr>
                </table>
                
                <h3>Preprocessing Pipeline</h3>
                <div class="code-header">
                    <span>preprocessing.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.impute import SimpleImputer

# 1. Handle categorical features
label_encoders = {}
for col in ['Irrigation_Schedule', 'Seed_Variety']:
    le = LabelEncoder()
    df[col] = le.fit_transform(df[col].astype(str))
    label_encoders[col] = le

# 2. Impute missing values with median
imputer = SimpleImputer(strategy='median')
X_imputed = imputer.fit_transform(X)

# 3. Standardize features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_imputed)

# 4. Train-test split (80/20)
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42
)</code></pre>
                </div>
            </section>

            <!-- Model Training Section -->
            <section id="model-training" class="section">
                <h2>ü§ñ Model Training</h2>
                <p>
                    Four regression algorithms were trained and evaluated. The Gradient Boosting Regressor 
                    achieved the best performance and was selected as the production model.
                </p>
                
                <h3>Algorithms Compared</h3>
                
                <div class="algo-card best">
                    <div class="algo-header">
                        <span class="algo-name">üèÜ Gradient Boosting Regressor</span>
                        <span class="algo-badge">SELECTED</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.9750</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">37.72</div>
                            <div class="algo-metric-label">MAE</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">52.20</div>
                            <div class="algo-metric-label">RMSE</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Random Forest Regressor</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.9735</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">38.29</div>
                            <div class="algo-metric-label">MAE</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">53.82</div>
                            <div class="algo-metric-label">RMSE</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Decision Tree Regressor</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.9568</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">49.23</div>
                            <div class="algo-metric-label">MAE</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">68.66</div>
                            <div class="algo-metric-label">RMSE</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Linear Regression</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.4936</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">188.08</div>
                            <div class="algo-metric-label">MAE</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">235.08</div>
                            <div class="algo-metric-label">RMSE</div>
                        </div>
                    </div>
                </div>
                
                <h3>Model Configuration</h3>
                <div class="code-header">
                    <span>model_config.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.ensemble import GradientBoostingRegressor

# Best Model Configuration
model = GradientBoostingRegressor(
    n_estimators=100,      # Number of boosting stages
    learning_rate=0.1,     # Shrinks contribution of each tree
    max_depth=3,           # Maximum depth of individual trees
    min_samples_split=2,   # Min samples to split internal node
    min_samples_leaf=1,    # Min samples at leaf node
    subsample=1.0,         # Fraction of samples for fitting trees
    random_state=42        # Reproducibility seed
)

# Training
model.fit(X_train, y_train)

# Save model
import joblib
joblib.dump(model, 'model/model.pkl')</code></pre>
                </div>
            </section>

            <!-- Model Evaluation Section -->
            <section id="model-evaluation" class="section">
                <h2>üìä Model Evaluation</h2>
                <p>
                    The model was evaluated using standard regression metrics on the held-out test set (20% of data).
                </p>
                
                <h3>Evaluation Metrics Explained</h3>
                <table class="tech-table">
                    <tr>
                        <th>Metric</th>
                        <th>Formula</th>
                        <th>Value</th>
                        <th>Interpretation</th>
                    </tr>
                    <tr>
                        <td><strong>R¬≤ (Coefficient of Determination)</strong></td>
                        <td><code>1 - (SS_res / SS_tot)</code></td>
                        <td>0.9750</td>
                        <td>97.5% variance explained</td>
                    </tr>
                    <tr>
                        <td><strong>MAE (Mean Absolute Error)</strong></td>
                        <td><code>mean(|y - ≈∑|)</code></td>
                        <td>37.72 kg/ha</td>
                        <td>Average prediction error</td>
                    </tr>
                    <tr>
                        <td><strong>RMSE (Root Mean Squared Error)</strong></td>
                        <td><code>sqrt(mean((y - ≈∑)¬≤))</code></td>
                        <td>52.20 kg/ha</td>
                        <td>Penalizes large errors</td>
                    </tr>
                </table>
                
                <div class="code-header">
                    <span>evaluation.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error
import numpy as np

# Predictions on test set
y_pred = model.predict(X_test)

# Calculate metrics
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
rmse = np.sqrt(mean_squared_error(y_test, y_pred))

print(f"R¬≤ Score: {r2:.4f}")   # 0.9750
print(f"MAE: {mae:.2f}")       # 37.72
print(f"RMSE: {rmse:.2f}")     # 52.20</code></pre>
                </div>
            </section>

            <!-- Feature Importance Section -->
            <section id="feature-importance" class="section">
                <h2>üìà Feature Importance</h2>
                <p>
                    Feature importance was extracted from the Random Forest model using Gini impurity-based importance.
                    The top features driving predictions are Irrigation Schedule and Seed Variety.
                </p>
                
                <h3>Importance Rankings</h3>
                <div style="margin: 30px 0;">
                    <div class="feature-bar">
                        <span class="feature-name">Irrigation_Schedule</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 100%;"></div>
                        </div>
                        <span class="feature-value">59.75%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Seed_Variety</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 55%;"></div>
                        </div>
                        <span class="feature-value">32.89%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Fertilizer_Amount</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 5.2%;"></div>
                        </div>
                        <span class="feature-value">3.14%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Rainfall_mm</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 4.2%;"></div>
                        </div>
                        <span class="feature-value">2.49%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Sunshine_hours</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 1.4%;"></div>
                        </div>
                        <span class="feature-value">0.87%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Soil_Quality</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 1.4%;"></div>
                        </div>
                        <span class="feature-value">0.86%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Other Features</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 0.1%;"></div>
                        </div>
                        <span class="feature-value">&lt;0.01%</span>
                    </div>
                </div>
                
                <h3>Key Insights</h3>
                <ul style="color: var(--text-secondary); line-height: 2;">
                    <li><strong>Irrigation Schedule (59.75%)</strong> - Most critical factor; proper irrigation timing dramatically affects yield</li>
                    <li><strong>Seed Variety (32.89%)</strong> - Selection of appropriate seed variety is second most important</li>
                    <li><strong>Fertilizer Amount (3.14%)</strong> - Moderate importance; optimal fertilization matters</li>
                    <li><strong>Weather factors</strong> - Rainfall and sunshine have measurable but smaller effects</li>
                    <li><strong>Soil nutrients (N/P/K)</strong> - Surprisingly low importance in this dataset, possibly due to adequate levels</li>
                </ul>
            </section>

            <!-- API Reference Section -->
            <section id="api-reference" class="section">
                <h2>üîå API Reference</h2>
                <p>
                    The Flask REST API exposes endpoints for health checks, feature information, and predictions.
                    All responses are JSON formatted.
                </p>
                
                <h3>Base URL</h3>
                <div class="code-block">
                    <pre><code>http://localhost:5000</code></pre>
                </div>
                
                <h3>Endpoints</h3>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/health</span>
                    <p class="endpoint-desc">Health check endpoint to verify API is running and model is loaded.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/features</span>
                    <p class="endpoint-desc">Returns list of required input features with descriptions and valid ranges.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/model-info</span>
                    <p class="endpoint-desc">Returns model metadata including name, performance metrics, and training date.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method post">POST</span>
                    <span class="endpoint-path">/predict</span>
                    <p class="endpoint-desc">Make a single yield prediction. Accepts JSON body with feature values.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method post">POST</span>
                    <span class="endpoint-path">/predict-batch</span>
                    <p class="endpoint-desc">Make batch predictions for multiple samples. Accepts array of feature objects.</p>
                </div>
                
                <h3>Example: Single Prediction</h3>
                <div class="code-header">
                    <span>curl_request.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash">curl -X POST http://localhost:5000/predict \
  -H "Content-Type: application/json" \
  -d '{
    "Rainfall_mm": 450,
    "Temperature_C": 28,
    "Humidity": 72,
    "Soil_Quality": 78,
    "Nitrogen": 45,
    "Phosphorus": 52,
    "Potassium": 38,
    "Fertilizer_Amount_kg_per_hectare": 165,
    "Sunshine_hours": 105,
    "Soil_Humidity": 55,
    "Irrigation_Schedule": 5,
    "Seed_Variety": 1
  }'</code></pre>
                </div>
                
                <h3>Example Response</h3>
                <div class="code-header">
                    <span>response.json</span>
                </div>
                <div class="code-block">
                    <pre><code class="language-json">{
  "status": "success",
  "prediction": {
    "yield_kg_per_hectare": 742.56,
    "yield_tons_per_hectare": 0.743
  },
  "input_features": {
    "Rainfall_mm": 450,
    "Temperature_C": 28,
    ...
  },
  "features_imputed": null
}</code></pre>
                </div>
            </section>

            <!-- Deployment Section -->
            <section id="deployment" class="section">
                <h2>üöÄ Deployment</h2>
                
                <h3>Local Development</h3>
                <div class="code-header">
                    <span>run_local.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash"># Activate virtual environment
source .venv/Scripts/activate  # Windows
# source .venv/bin/activate    # Linux/Mac

# Install dependencies
pip install -r api/requirements.txt

# Run Flask development server
cd Phase-2/api
python app.py

# Server runs on http://localhost:5000</code></pre>
                </div>
                
                <h3>Production Deployment (Gunicorn)</h3>
                <div class="code-header">
                    <span>run_production.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash"># Install gunicorn
pip install gunicorn

# Run with gunicorn (4 workers)
cd Phase-2/api
gunicorn -w 4 -b 0.0.0.0:5000 app:app</code></pre>
                </div>
                
                <h3>Docker Deployment</h3>
                <div class="code-header">
                    <span>Dockerfile</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY api/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY api/ ./api/
COPY model/ ./model/

EXPOSE 5000

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "api.app:app"]</code></pre>
                </div>
            </section>

            <!-- Code Samples Section -->
            <section id="code-samples" class="section">
                <h2>üíª Code Samples</h2>
                
                <h3>Python Client</h3>
                <div class="code-header">
                    <span>client.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">import requests

API_URL = "http://localhost:5000"

def predict_yield(features: dict) -> float:
    """
    Make a yield prediction via the API.
    
    Args:
        features: Dictionary of input features
        
    Returns:
        Predicted yield in kg/hectare
    """
    response = requests.post(
        f"{API_URL}/predict",
        json=features
    )
    result = response.json()
    
    if result['status'] == 'success':
        return result['prediction']['yield_kg_per_hectare']
    else:
        raise Exception(result['message'])

# Example usage
features = {
    "Rainfall_mm": 500,
    "Temperature_C": 25,
    "Humidity": 70,
    "Soil_Quality": 75,
    "Fertilizer_Amount_kg_per_hectare": 150,
    "Irrigation_Schedule": 5,
    "Seed_Variety": 1
}

predicted_yield = predict_yield(features)
print(f"Predicted Yield: {predicted_yield:.2f} kg/ha")</code></pre>
                </div>
                
                <h3>JavaScript/Fetch Client</h3>
                <div class="code-header">
                    <span>client.js</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-javascript">async function predictYield(features) {
    const response = await fetch('http://localhost:5000/predict', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(features)
    });
    
    const result = await response.json();
    
    if (result.status === 'success') {
        return result.prediction.yield_kg_per_hectare;
    } else {
        throw new Error(result.message);
    }
}

// Usage
const features = {
    Rainfall_mm: 500,
    Temperature_C: 25,
    Humidity: 70,
    Soil_Quality: 75,
    Irrigation_Schedule: 5,
    Seed_Variety: 1
};

predictYield(features)
    .then(yield => console.log(`Predicted: ${yield} kg/ha`))
    .catch(err => console.error(err));</code></pre>
                </div>
                
                <h3>Load Model for Local Inference</h3>
                <div class="code-header">
                    <span>local_inference.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">import joblib
import numpy as np

# Load artifacts
model = joblib.load('model/model.pkl')
scaler = joblib.load('model/scaler.pkl')
imputer = joblib.load('model/imputer.pkl')
features = joblib.load('model/feature_list.pkl')

def predict(input_dict):
    """Make prediction without API"""
    # Build feature vector
    X = np.array([[input_dict.get(f, np.nan) for f in features]])
    
    # Preprocess
    X_imputed = imputer.transform(X)
    X_scaled = scaler.transform(X_imputed)
    
    # Predict
    return max(0, model.predict(X_scaled)[0])

# Usage
result = predict({
    "Rainfall_mm": 500,
    "Temperature_C": 25,
    "Irrigation_Schedule": 5,
    "Seed_Variety": 1
})
print(f"Yield: {result:.2f} kg/ha")</code></pre>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Syntax highlighting
        hljs.highlightAll();
        
        // Copy code functionality
        function copyCode(btn) {
            const codeBlock = btn.closest('.code-header').nextElementSibling;
            const code = codeBlock.querySelector('code').innerText;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = btn.innerText;
                btn.innerText = 'Copied!';
                setTimeout(() => btn.innerText = originalText, 2000);
            });
        }
        
        // Smooth scrolling for sidebar links
        document.querySelectorAll('.sidebar-nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').slice(1);
                document.getElementById(targetId).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        
        // Highlight active section in sidebar
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.sidebar-nav a');
        
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.style.borderLeftColor = 'transparent';
                link.style.color = 'var(--text-secondary)';
                if (link.getAttribute('href').slice(1) === current) {
                    link.style.borderLeftColor = 'var(--primary-color)';
                    link.style.color = 'var(--primary-color)';
                }
            });
        });
    </script>
</body>
</html>
