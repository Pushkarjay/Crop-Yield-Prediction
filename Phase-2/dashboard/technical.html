<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Technical Documentation - Crop Yield Prediction</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        /* Technical Page Specific Styles */
        :root {
            --code-bg: #1e1e2e;
            --code-text: #cdd6f4;
            --accent-blue: #89b4fa;
            --accent-green: #a6e3a1;
            --accent-yellow: #f9e2af;
            --accent-red: #f38ba8;
            --accent-purple: #cba6f7;
        }
        
        .tech-nav {
            position: sticky;
            top: 0;
            background: var(--card-background);
            padding: 15px 30px;
            box-shadow: var(--shadow-md);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tech-nav-links {
            display: flex;
            gap: 20px;
        }
        
        .tech-nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 8px 16px;
            border-radius: 6px;
            transition: var(--transition);
        }
        
        .tech-nav-links a:hover,
        .tech-nav-links a.active {
            background: var(--primary-color);
            color: white;
        }
        
        .tech-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 30px;
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .sidebar {
            position: sticky;
            top: 80px;
            height: fit-content;
            background: var(--card-background);
            border-radius: var(--radius-md);
            padding: 20px;
            box-shadow: var(--shadow-sm);
        }
        
        .sidebar h3 {
            font-size: 0.85rem;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: 15px;
            letter-spacing: 1px;
        }
        
        .sidebar-nav {
            list-style: none;
        }
        
        .sidebar-nav li {
            margin-bottom: 8px;
        }
        
        .sidebar-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
            border-left: 3px solid transparent;
            transition: var(--transition);
        }
        
        .sidebar-nav a:hover {
            background: #f0f0f0;
            border-left-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .content-area {
            background: var(--card-background);
            border-radius: var(--radius-lg);
            padding: 40px;
            box-shadow: var(--shadow-md);
        }
        
        .section {
            margin-bottom: 50px;
            padding-bottom: 40px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section h3 {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin: 25px 0 15px;
        }
        
        .section p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        /* Code Blocks */
        .code-block {
            background: var(--code-bg);
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
            position: relative;
        }
        
        .code-block pre {
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .code-block code {
            color: var(--code-text);
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #313244;
            border-radius: var(--radius-md) var(--radius-md) 0 0;
            margin: 20px 0 0;
        }
        
        .code-header span {
            color: var(--accent-blue);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        .code-header + .code-block {
            margin-top: 0;
            border-radius: 0 0 var(--radius-md) var(--radius-md);
        }
        
        .copy-btn {
            background: var(--accent-purple);
            color: var(--code-bg);
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .copy-btn:hover {
            opacity: 0.8;
        }
        
        /* Tables */
        .tech-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95rem;
        }
        
        .tech-table th,
        .tech-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .tech-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .tech-table tr:hover {
            background: #f8f9fa;
        }
        
        .tech-table code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
        }
        
        /* Metric Cards */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 25px;
            border-radius: var(--radius-md);
            text-align: center;
        }
        
        .metric-card.secondary {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
        }
        
        .metric-card.tertiary {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* Feature Importance Chart */
        .feature-bar {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .feature-name {
            width: 200px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .feature-bar-container {
            flex: 1;
            height: 24px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .feature-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .feature-value {
            width: 80px;
            text-align: right;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        /* Algorithm Comparison */
        .algo-card {
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 15px;
            transition: var(--transition);
        }
        
        .algo-card:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
        }
        
        .algo-card.best {
            border-color: var(--success-color);
            background: rgba(76, 175, 80, 0.05);
        }
        
        .algo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .algo-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .algo-badge {
            background: var(--success-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .algo-metrics {
            display: flex;
            gap: 30px;
        }
        
        .algo-metric {
            text-align: center;
        }
        
        .algo-metric-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .algo-metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        /* Workflow Diagram */
        .workflow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 0;
            overflow-x: auto;
        }
        
        .workflow-step {
            text-align: center;
            min-width: 120px;
        }
        
        .workflow-icon {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin: 0 auto 10px;
        }
        
        .workflow-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .workflow-arrow {
            color: var(--border-color);
            font-size: 1.5rem;
        }
        
        /* API Endpoint */
        .endpoint {
            background: #f8f9fa;
            border-radius: var(--radius-md);
            padding: 20px;
            margin: 15px 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .endpoint-method {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 10px;
        }
        
        .endpoint-method.get { background: #10b981; color: white; }
        .endpoint-method.post { background: #3b82f6; color: white; }
        
        .endpoint-path {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            color: var(--text-primary);
        }
        
        .endpoint-desc {
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .tech-container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: relative;
                top: 0;
            }
            
            .workflow {
                flex-direction: column;
                gap: 20px;
            }
            
            .workflow-arrow {
                transform: rotate(90deg);
            }
        }
        
        /* Data Status Cards */
        .data-status-cards {
            display: flex;
            flex-direction: column;
            gap: 25px;
            margin: 25px 0;
        }
        
        .data-status-card {
            border-radius: var(--radius-md);
            padding: 25px;
            border: 2px solid;
        }
        
        .data-status-card.good {
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.05), rgba(76, 175, 80, 0.1));
            border-color: #4caf50;
        }
        
        .data-status-card.partial {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.05), rgba(255, 193, 7, 0.1));
            border-color: #ffc107;
        }
        
        .data-status-card.contextual {
            background: linear-gradient(135deg, rgba(120, 144, 156, 0.05), rgba(120, 144, 156, 0.1));
            border-color: #78909c;
        }
        
        .status-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .status-header h4 {
            margin: 0;
            font-size: 1.2rem;
        }
        
        .status-icon {
            font-size: 1.5rem;
        }
        
        .data-status-card p {
            margin-bottom: 20px;
            color: var(--text-secondary);
        }
        
        .warning-box {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(255, 193, 7, 0.15);
            border-left: 4px solid #ffc107;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
        
        .info-box {
            margin-top: 15px;
            padding: 12px 16px;
            background: rgba(33, 150, 243, 0.1);
            border-left: 4px solid #2196f3;
            border-radius: 0 8px 8px 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="tech-nav">
        <div class="logo">
            <span class="logo-icon">üåæ</span>
            <strong>Crop Yield Prediction</strong>
        </div>
        <div class="tech-nav-links">
            <a href="index.html">Dashboard</a>
            <a href="technical.html" class="active">Technical Docs</a>
            <a href="report.html">Quick View</a>
        </div>
    </nav>

    <div class="tech-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Contents</h3>
            <ul class="sidebar-nav">
                <li><a href="#overview">Project Overview</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#data-pipeline">Data Pipeline</a></li>
                <li><a href="#data-status">Data Field Status</a></li>
                <li><a href="#feature-engineering">Feature Engineering</a></li>
                <li><a href="#model-training">Model Training</a></li>
                <li><a href="#model-evaluation">Model Evaluation</a></li>
                <li><a href="#feature-importance">Feature Importance</a></li>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#deployment">Deployment</a></li>
                <li><a href="#code-samples">Code Samples</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="content-area">
            <!-- Overview Section -->
            <section id="overview" class="section">
                <h2>üìã Project Overview</h2>
                <p>
                    This project implements an end-to-end machine learning pipeline for predicting crop yield 
                    based on environmental, soil, and management factors. The system processes multiple heterogeneous 
                    datasets, performs feature engineering, trains multiple regression models, and serves predictions 
                    via a REST API.
                </p>
                
                <div class="metric-grid">
                    <div class="metric-card">
                        <div class="metric-value">75,000</div>
                        <div class="metric-label">Synthetic Samples</div>
                    </div>
                    <div class="metric-card secondary">
                        <div class="metric-value">22</div>
                        <div class="metric-label">Features Used</div>
                    </div>
                    <div class="metric-card tertiary">
                        <div class="metric-value">96.27%</div>
                        <div class="metric-label">R¬≤ Score</div>
                    </div>
                </div>
                
                <h3>Tech Stack</h3>
                <table class="tech-table">
                    <tr>
                        <th>Component</th>
                        <th>Technology</th>
                        <th>Version</th>
                    </tr>
                    <tr>
                        <td>Language</td>
                        <td><code>Python</code></td>
                        <td>3.11.9</td>
                    </tr>
                    <tr>
                        <td>Data Processing</td>
                        <td><code>pandas</code>, <code>numpy</code></td>
                        <td>2.3.x, 2.3.x</td>
                    </tr>
                    <tr>
                        <td>ML Framework</td>
                        <td><code>scikit-learn</code></td>
                        <td>1.5.x</td>
                    </tr>
                    <tr>
                        <td>Visualization</td>
                        <td><code>matplotlib</code>, <code>seaborn</code></td>
                        <td>3.9.x, 0.13.x</td>
                    </tr>
                    <tr>
                        <td>API Framework</td>
                        <td><code>Flask</code></td>
                        <td>3.1.x</td>
                    </tr>
                    <tr>
                        <td>Model Serialization</td>
                        <td><code>joblib</code></td>
                        <td>1.4.x</td>
                    </tr>
                </table>
            </section>

            <!-- Architecture Section -->
            <section id="architecture" class="section">
                <h2>üèóÔ∏è System Architecture</h2>
                <p>
                    The system follows a modular architecture with clear separation between data processing, 
                    model training, and serving layers.
                </p>
                
                <div class="workflow">
                    <div class="workflow-step">
                        <div class="workflow-icon">üìÅ</div>
                        <div class="workflow-label">Raw Data<br>(6 files)</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üîÑ</div>
                        <div class="workflow-label">ETL<br>Pipeline</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üßπ</div>
                        <div class="workflow-label">Feature<br>Engineering</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">ü§ñ</div>
                        <div class="workflow-label">Model<br>Training</div>
                    </div>
                    <div class="workflow-arrow">‚Üí</div>
                    <div class="workflow-step">
                        <div class="workflow-icon">üöÄ</div>
                        <div class="workflow-label">REST<br>API</div>
                    </div>
                </div>
                
                <div class="code-header">
                    <span>project_structure.txt</span>
                </div>
                <div class="code-block">
                    <pre><code>Phase-2/
‚îú‚îÄ‚îÄ unified_dataset.csv      # 75,000 synthetic records
‚îú‚îÄ‚îÄ generate_synthetic_dataset.py  # Dataset generator
‚îú‚îÄ‚îÄ train_model.py           # ML training pipeline
‚îÇ
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îú‚îÄ‚îÄ model.pkl            # Trained GradientBoostingRegressor
‚îÇ   ‚îú‚îÄ‚îÄ scaler.pkl           # StandardScaler for normalization
‚îÇ   ‚îú‚îÄ‚îÄ label_encoders.pkl   # Categorical encoders (Crop, State, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ feature_list.pkl     # 22 feature names for inference
‚îÇ   ‚îî‚îÄ‚îÄ model_info.pkl       # Model metadata and metrics
‚îÇ
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ app.py               # Flask REST API
‚îÇ
‚îî‚îÄ‚îÄ dashboard/
    ‚îú‚îÄ‚îÄ index.html           # User-facing prediction UI
    ‚îú‚îÄ‚îÄ technical.html       # This documentation
    ‚îî‚îÄ‚îÄ style.css, script.js</code></pre>
                </div>
            </section>

            <!-- Data Pipeline Section -->
            <section id="data-pipeline" class="section">
                <h2>üîÑ Data Pipeline</h2>
                <p>
                    Due to data quality issues in the original heterogeneous datasets (missing values, inconsistent
                    schemas, incomplete coverage), a synthetic dataset of 75,000 records was generated with realistic
                    correlations between agricultural features. The synthetic data covers 22 crops across 20 Indian
                    states from 2015-2024.
                </p>
                
                <h3>Synthetic Dataset Properties</h3>
                <table class="tech-table">
                    <tr>
                        <th>Property</th>
                        <th>Value</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Total Records</td>
                        <td>75,000</td>
                        <td>Complete records with no missing values</td>
                    </tr>
                    <tr>
                        <td>Crops</td>
                        <td>22 types</td>
                        <td>Rice, Wheat, Maize, Cotton, Sugarcane, Soybean, etc.</td>
                    </tr>
                    <tr>
                        <td>States</td>
                        <td>20 Indian states</td>
                        <td>Punjab, Maharashtra, UP, MP, Karnataka, etc.</td>
                    </tr>
                    <tr>
                        <td>Years</td>
                        <td>2015-2024</td>
                        <td>10-year range with seasonal variations</td>
                    </tr>
                    <tr>
                        <td>Features</td>
                        <td>27 columns</td>
                        <td>22 used for ML prediction</td>
                    </tr>
                </table>
                
                <h3>Column Mapping Strategy</h3>
                <div class="code-header">
                    <span>column_mapping.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">COLUMN_MAPPING = {
    # Soil Nutrients
    'N_SOIL': 'Nitrogen',
    'P_SOIL': 'Phosphorus', 
    'K_SOIL': 'Potassium',
    'Nitrogen (N)': 'Nitrogen',
    
    # Temperature variations
    'TEMPERATURE': 'Temperature_C',
    'Air temperature (C)': 'Temperature_C',
    'Temperatue': 'Temperature_C',  # typo in source
    'Mean Temp': 'Temperature_C',
    
    # Humidity variations
    'HUMIDITY': 'Humidity',
    'Air humidity (%)': 'Humidity',
    'Average Humidity': 'Humidity',
    
    # Target variable mappings
    'Yield_kg_per_hectare': 'Yield_kg_per_hectare',
    'Crop Yield': 'Yield_kg_per_hectare',
    'Yeild (Q/acre)': 'Yield_kg_per_hectare',
    'millet yield': 'Yield_kg_per_hectare',
}</code></pre>
                </div>
            </section>

            <!-- Data Field Status Section -->
            <section id="data-status" class="section">
                <h2>üìä Data Field Status</h2>
                <p>
                    With the synthetic dataset, all 75,000 records have complete values for all features.
                    No imputation is required, ensuring high-quality predictions across all input combinations.
                </p>
                
                <h3>Complete Feature Coverage (75K samples each)</h3>
                <div class="data-status-cards">
                    <div class="data-status-card good">
                        <div class="status-header">
                            <span class="status-icon">üü¢</span>
                            <h4>Weather Features</h4>
                        </div>
                        <p>All weather parameters with 100% coverage</p>
                        <table class="tech-table">
                            <tr><th>Feature</th><th>Samples</th><th>Range</th></tr>
                            <tr><td><code>Rainfall_mm</code></td><td>75,000</td><td>200 - 2500 mm</td></tr>
                            <tr><td><code>Temperature_C</code></td><td>75,000</td><td>15 - 42¬∞C</td></tr>
                            <tr><td><code>Humidity</code></td><td>75,000</td><td>30 - 95%</td></tr>
                            <tr><td><code>Sunshine_Hours</code></td><td>75,000</td><td>4 - 10 hrs</td></tr>
                            <tr><td><code>GDD</code></td><td>75,000</td><td>1000 - 3000</td></tr>
                            <tr><td><code>Pressure_KPa</code></td><td>75,000</td><td>95 - 105 kPa</td></tr>
                            <tr><td><code>Wind_Speed_Kmh</code></td><td>75,000</td><td>5 - 30 km/h</td></tr>
                        </table>
                    </div>
                    
                    <div class="data-status-card good">
                        <div class="status-header">
                            <span class="status-icon">üü¢</span>
                            <h4>Soil & Nutrient Features</h4>
                        </div>
                        <p>Complete soil parameters for all records</p>
                        <table class="tech-table">
                            <tr><th>Feature</th><th>Samples</th><th>Range</th></tr>
                            <tr><td><code>Soil_Quality</code></td><td>75,000</td><td>40 - 100</td></tr>
                            <tr><td><code>Nitrogen</code></td><td>75,000</td><td>20 - 120 kg/ha</td></tr>
                            <tr><td><code>Phosphorus</code></td><td>75,000</td><td>10 - 80 kg/ha</td></tr>
                            <tr><td><code>Potassium</code></td><td>75,000</td><td>15 - 100 kg/ha</td></tr>
                            <tr><td><code>Soil_pH</code></td><td>75,000</td><td>5.5 - 8.5</td></tr>
                            <tr><td><code>OrganicCarbon</code></td><td>75,000</td><td>0.3 - 2.5%</td></tr>
                            <tr><td><code>Soil_Moisture</code></td><td>75,000</td><td>20 - 70%</td></tr>
                        </table>
                    </div>
                    
                    <div class="data-status-card good">
                        <div class="status-header">
                            <span class="status-icon">üü¢</span>
                            <h4>Management & Location Features</h4>
                        </div>
                        <p>Categorical and management parameters</p>
                        <table class="tech-table">
                            <tr><th>Feature</th><th>Samples</th><th>Categories/Range</th></tr>
                            <tr><td><code>Crop</code></td><td>75,000</td><td>22 crop types</td></tr>
                            <tr><td><code>State</code></td><td>75,000</td><td>20 Indian states</td></tr>
                            <tr><td><code>Year</code></td><td>75,000</td><td>2015 - 2024</td></tr>
                            <tr><td><code>Fertilizer_Amount</code></td><td>75,000</td><td>50 - 350 kg/ha</td></tr>
                            <tr><td><code>Irrigation_Type</code></td><td>75,000</td><td>Drip, Sprinkler, Canal, Rainfed</td></tr>
                            <tr><td><code>Seed_Variety</code></td><td>75,000</td><td>Local, Improved, Hybrid</td></tr>
                            <tr><td><code>Pesticide_Usage</code></td><td>75,000</td><td>0 - 20 kg/ha</td></tr>
                        </table>
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    ‚úÖ <strong>Synthetic Data Advantage:</strong> Unlike the original datasets which had 
                    significant missing values requiring imputation, the synthetic dataset provides complete 
                    coverage with realistic correlations between agricultural factors, resulting in more 
                    reliable predictions.
                </div>
            </section>

            <!-- Feature Engineering Section -->
            <section id="feature-engineering" class="section">
                <h2>‚öôÔ∏è Feature Engineering</h2>
                <p>
                    The final model uses 22 features across weather, soil, management, and location categories.
                    The dataset is synthetically generated with 75,000 records covering 22 crops across 20 Indian states
                    from 2015-2024, ensuring complete data coverage with realistic correlations.
                </p>
                
                <h3>Feature Schema (22 ML Features)</h3>
                <table class="tech-table">
                    <tr>
                        <th>Category</th>
                        <th>Feature</th>
                        <th>Type</th>
                        <th>Range</th>
                        <th>Preprocessing</th>
                    </tr>
                    <tr>
                        <td rowspan="7">üå§Ô∏è Weather</td>
                        <td><code>Rainfall_mm</code></td>
                        <td>float64</td>
                        <td>200 - 2500</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Temperature_C</code></td>
                        <td>float64</td>
                        <td>15 - 42</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Humidity</code></td>
                        <td>float64</td>
                        <td>30 - 95</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Sunshine_Hours</code></td>
                        <td>float64</td>
                        <td>4 - 10</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>GDD</code></td>
                        <td>float64</td>
                        <td>1000 - 3000</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Pressure_KPa</code></td>
                        <td>float64</td>
                        <td>95 - 105</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Wind_Speed_Kmh</code></td>
                        <td>float64</td>
                        <td>5 - 30</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td rowspan="7">üå± Soil</td>
                        <td><code>Soil_Quality</code></td>
                        <td>float64</td>
                        <td>40 - 100</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Soil_Moisture</code></td>
                        <td>float64</td>
                        <td>20 - 70</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Nitrogen</code></td>
                        <td>float64</td>
                        <td>20 - 120</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Phosphorus</code></td>
                        <td>float64</td>
                        <td>10 - 80</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Potassium</code></td>
                        <td>float64</td>
                        <td>15 - 100</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Soil_pH</code></td>
                        <td>float64</td>
                        <td>5.5 - 8.5</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>OrganicCarbon</code></td>
                        <td>float64</td>
                        <td>0.3 - 2.5</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td rowspan="6">üöú Management</td>
                        <td><code>Fertilizer_Amount</code></td>
                        <td>float64</td>
                        <td>50 - 350</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Irrigation_Type</code></td>
                        <td>categorical</td>
                        <td>4 types</td>
                        <td>LabelEncoder</td>
                    </tr>
                    <tr>
                        <td><code>Seed_Variety</code></td>
                        <td>categorical</td>
                        <td>3 types</td>
                        <td>LabelEncoder</td>
                    </tr>
                    <tr>
                        <td><code>Pesticide_Usage</code></td>
                        <td>float64</td>
                        <td>0 - 20</td>
                        <td>StandardScaler</td>
                    </tr>
                    <tr>
                        <td><code>Crop</code></td>
                        <td>categorical</td>
                        <td>22 types</td>
                        <td>LabelEncoder</td>
                    </tr>
                    <tr>
                        <td><code>State</code></td>
                        <td>categorical</td>
                        <td>20 states</td>
                        <td>LabelEncoder</td>
                    </tr>
                    <tr>
                        <td>üìÖ Time</td>
                        <td><code>Year</code></td>
                        <td>int64</td>
                        <td>2015 - 2024</td>
                        <td>StandardScaler</td>
                    </tr>
                </table>
                
                <h3>Preprocessing Pipeline</h3>
                <div class="code-header">
                    <span>preprocessing.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.preprocessing import StandardScaler, LabelEncoder

# 1. Handle categorical features
label_encoders = {}
for col in ['Crop', 'State', 'Irrigation_Type', 'Seed_Variety']:
    le = LabelEncoder()
    df[f'{col}_Encoded'] = le.fit_transform(df[col])
    label_encoders[col] = le

# 2. Standardize numerical features (no imputation needed - synthetic data is complete)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# 3. Train-test split (80/20)
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=42
)</code></pre>
                </div>
            </section>

            <!-- Model Training Section -->
            <section id="model-training" class="section">
                <h2>ü§ñ Model Training</h2>
                <p>
                    Four regression algorithms were trained and evaluated. The Gradient Boosting Regressor 
                    achieved the best performance and was selected as the production model.
                </p>
                
                <h3>Algorithms Compared</h3>
                
                <div class="algo-card best">
                    <div class="algo-header">
                        <span class="algo-name">üèÜ Gradient Boosting Regressor</span>
                        <span class="algo-badge">SELECTED</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.9627</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">1,610</div>
                            <div class="algo-metric-label">MAE (kg/ha)</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">3,574</div>
                            <div class="algo-metric-label">RMSE (kg/ha)</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Random Forest Regressor</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.9594</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">1,603</div>
                            <div class="algo-metric-label">MAE (kg/ha)</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">3,728</div>
                            <div class="algo-metric-label">RMSE (kg/ha)</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Decision Tree Regressor</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.8834</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">2,514</div>
                            <div class="algo-metric-label">MAE (kg/ha)</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">6,314</div>
                            <div class="algo-metric-label">RMSE (kg/ha)</div>
                        </div>
                    </div>
                </div>
                
                <div class="algo-card">
                    <div class="algo-header">
                        <span class="algo-name">Linear Regression</span>
                    </div>
                    <div class="algo-metrics">
                        <div class="algo-metric">
                            <div class="algo-metric-value">0.7156</div>
                            <div class="algo-metric-label">R¬≤ Score</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">5,221</div>
                            <div class="algo-metric-label">MAE (kg/ha)</div>
                        </div>
                        <div class="algo-metric">
                            <div class="algo-metric-value">9,866</div>
                            <div class="algo-metric-label">RMSE (kg/ha)</div>
                        </div>
                    </div>
                </div>
                
                <h3>Model Configuration</h3>
                <div class="code-header">
                    <span>model_config.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.ensemble import GradientBoostingRegressor

# Best Model Configuration
model = GradientBoostingRegressor(
    n_estimators=100,      # Number of boosting stages
    learning_rate=0.1,     # Shrinks contribution of each tree
    max_depth=3,           # Maximum depth of individual trees
    min_samples_split=2,   # Min samples to split internal node
    min_samples_leaf=1,    # Min samples at leaf node
    subsample=1.0,         # Fraction of samples for fitting trees
    random_state=42        # Reproducibility seed
)

# Training
model.fit(X_train, y_train)

# Save model
import joblib
joblib.dump(model, 'model/model.pkl')</code></pre>
                </div>
            </section>

            <!-- Model Evaluation Section -->
            <section id="model-evaluation" class="section">
                <h2>üìä Model Evaluation</h2>
                <p>
                    The model was evaluated using standard regression metrics on the held-out test set (20% of data).
                </p>
                
                <h3>Evaluation Metrics Explained</h3>
                <table class="tech-table">
                    <tr>
                        <th>Metric</th>
                        <th>Formula</th>
                        <th>Value</th>
                        <th>Interpretation</th>
                    </tr>
                    <tr>
                        <td><strong>R¬≤ (Coefficient of Determination)</strong></td>
                        <td><code>1 - (SS_res / SS_tot)</code></td>
                        <td>0.9627</td>
                        <td>96.27% variance explained</td>
                    </tr>
                    <tr>
                        <td><strong>MAE (Mean Absolute Error)</strong></td>
                        <td><code>mean(|y - ≈∑|)</code></td>
                        <td>1,610 kg/ha</td>
                        <td>Average prediction error</td>
                    </tr>
                    <tr>
                        <td><strong>RMSE (Root Mean Squared Error)</strong></td>
                        <td><code>sqrt(mean((y - ≈∑)¬≤))</code></td>
                        <td>3,574 kg/ha</td>
                        <td>Penalizes large errors</td>
                    </tr>
                </table>
                
                <div class="code-header">
                    <span>evaluation.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">from sklearn.metrics import r2_score, mean_absolute_error, mean_squared_error
import numpy as np

# Predictions on test set
y_pred = model.predict(X_test)

# Calculate metrics
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)
rmse = np.sqrt(mean_squared_error(y_test, y_pred))

print(f"R¬≤ Score: {r2:.4f}")   # 0.9627
print(f"MAE: {mae:.2f}")       # 1610.29
print(f"RMSE: {rmse:.2f}")     # 3573.78</code></pre>
                </div>
            </section>

            <!-- Feature Importance Section -->
            <section id="feature-importance" class="section">
                <h2>üìà Feature Importance</h2>
                <p>
                    Feature importance was extracted from the Gradient Boosting model. The top features 
                    driving predictions are Crop type, State, and various agricultural parameters.
                </p>
                
                <h3>Top Feature Importance Rankings</h3>
                <div style="margin: 30px 0;">
                    <div class="feature-bar">
                        <span class="feature-name">Crop_Encoded</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 100%;"></div>
                        </div>
                        <span class="feature-value">~25%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Year</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 70%;"></div>
                        </div>
                        <span class="feature-value">~18%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Rainfall_mm</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 50%;"></div>
                        </div>
                        <span class="feature-value">~12%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Fertilizer_Amount</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 45%;"></div>
                        </div>
                        <span class="feature-value">~11%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Temperature_C</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 35%;"></div>
                        </div>
                        <span class="feature-value">~9%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Soil_Quality</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 30%;"></div>
                        </div>
                        <span class="feature-value">~7%</span>
                    </div>
                    <div class="feature-bar">
                        <span class="feature-name">Other 16 Features</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar-fill" style="width: 25%;"></div>
                        </div>
                        <span class="feature-value">~18%</span>
                    </div>
                </div>
                
                <h3>Key Insights</h3>
                <ul style="color: var(--text-secondary); line-height: 2;">
                    <li><strong>Crop Type (~25%)</strong> - Most critical factor; different crops have vastly different base yields</li>
                    <li><strong>Year (~18%)</strong> - Captures annual variations and agricultural improvements over time</li>
                    <li><strong>Rainfall (~12%)</strong> - Water availability is crucial for crop growth</li>
                    <li><strong>Fertilizer Amount (~11%)</strong> - Optimal fertilization significantly impacts yield</li>
                    <li><strong>Temperature (~9%)</strong> - Each crop has optimal temperature ranges</li>
                    <li><strong>Soil Quality (~7%)</strong> - Foundation for healthy crop growth</li>
                </ul>
            </section>

            <!-- API Reference Section -->
            <section id="api-reference" class="section">
                <h2>üîå API Reference</h2>
                <p>
                    The Flask REST API exposes endpoints for health checks, feature information, and predictions.
                    All responses are JSON formatted.
                </p>
                
                <h3>Base URL</h3>
                <div class="code-block">
                    <pre><code>http://localhost:5000</code></pre>
                </div>
                
                <h3>Endpoints</h3>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/health</span>
                    <p class="endpoint-desc">Health check endpoint to verify API is running and model is loaded.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/features</span>
                    <p class="endpoint-desc">Returns list of required input features with descriptions and valid ranges.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method get">GET</span>
                    <span class="endpoint-path">/model-info</span>
                    <p class="endpoint-desc">Returns model metadata including name, performance metrics, and training date.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method post">POST</span>
                    <span class="endpoint-path">/predict</span>
                    <p class="endpoint-desc">Make a single yield prediction. Accepts JSON body with feature values.</p>
                </div>
                
                <div class="endpoint">
                    <span class="endpoint-method post">POST</span>
                    <span class="endpoint-path">/predict-batch</span>
                    <p class="endpoint-desc">Make batch predictions for multiple samples. Accepts array of feature objects.</p>
                </div>
                
                <h3>Example: Single Prediction</h3>
                <div class="code-header">
                    <span>curl_request.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash">curl -X POST http://localhost:5000/predict \
  -H "Content-Type: application/json" \
  -d '{
    "Crop": "Rice",
    "State": "Punjab",
    "Year": 2024,
    "Rainfall_mm": 1200,
    "Temperature_C": 28,
    "Humidity": 70,
    "Soil_Quality": 75,
    "Nitrogen": 45,
    "Phosphorus": 35,
    "Potassium": 42,
    "Fertilizer_Amount": 180,
    "Irrigation_Type": "Canal",
    "Seed_Variety": "Hybrid",
    "Pesticide_Usage": 8.5
  }'</code></pre>
                </div>
                
                <h3>Example Response</h3>
                <div class="code-header">
                    <span>response.json</span>
                </div>
                <div class="code-block">
                    <pre><code class="language-json">{
  "status": "success",
  "predicted_yield_kg_per_hectare": 4256.78,
  "crop": "Rice",
  "state": "Punjab"
}</code></pre>
                </div>
            </section>

            <!-- Deployment Section -->
            <section id="deployment" class="section">
                <h2>üöÄ Deployment</h2>
                
                <h3>Local Development</h3>
                <div class="code-header">
                    <span>run_local.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash"># Activate virtual environment
source .venv/Scripts/activate  # Windows
# source .venv/bin/activate    # Linux/Mac

# Install dependencies
pip install -r api/requirements.txt

# Run Flask development server
cd Phase-2/api
python app.py

# Server runs on http://localhost:5000</code></pre>
                </div>
                
                <h3>Production Deployment (Gunicorn)</h3>
                <div class="code-header">
                    <span>run_production.sh</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-bash"># Install gunicorn
pip install gunicorn

# Run with gunicorn (4 workers)
cd Phase-2/api
gunicorn -w 4 -b 0.0.0.0:5000 app:app</code></pre>
                </div>
                
                <h3>Docker Deployment</h3>
                <div class="code-header">
                    <span>Dockerfile</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY api/requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY api/ ./api/
COPY model/ ./model/

EXPOSE 5000

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "api.app:app"]</code></pre>
                </div>
            </section>

            <!-- Code Samples Section -->
            <section id="code-samples" class="section">
                <h2>üíª Code Samples</h2>
                
                <h3>Python Client</h3>
                <div class="code-header">
                    <span>client.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">import requests

API_URL = "http://localhost:5000"

def predict_yield(features: dict) -> float:
    """
    Make a yield prediction via the API.
    
    Args:
        features: Dictionary of input features
        
    Returns:
        Predicted yield in kg/hectare
    """
    response = requests.post(
        f"{API_URL}/predict",
        json=features
    )
    result = response.json()
    
    if result['status'] == 'success':
        return result['predicted_yield_kg_per_hectare']
    else:
        raise Exception(result.get('error', 'Unknown error'))

# Example usage
features = {
    "Crop": "Rice",
    "State": "Punjab",
    "Year": 2024,
    "Rainfall_mm": 1200,
    "Temperature_C": 28,
    "Humidity": 70,
    "Soil_Quality": 75,
    "Fertilizer_Amount": 180,
    "Irrigation_Type": "Canal",
    "Seed_Variety": "Hybrid"
}

predicted_yield = predict_yield(features)
print(f"Predicted Yield: {predicted_yield:.2f} kg/ha")</code></pre>
                </div>
                
                <h3>JavaScript/Fetch Client</h3>
                <div class="code-header">
                    <span>client.js</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-javascript">async function predictYield(features) {
    const response = await fetch('http://localhost:5000/predict', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(features)
    });
    
    const result = await response.json();
    
    if (result.status === 'success') {
        return result.predicted_yield_kg_per_hectare;
    } else {
        throw new Error(result.error || 'Unknown error');
    }
}

// Usage
const features = {
    Crop: "Rice",
    State: "Punjab",
    Year: 2024,
    Rainfall_mm: 1200,
    Temperature_C: 28,
    Humidity: 70,
    Soil_Quality: 75,
    Irrigation_Type: "Canal",
    Seed_Variety: "Hybrid"
};

predictYield(features)
    .then(yieldValue => console.log(`Predicted: ${yieldValue} kg/ha`))
    .catch(err => console.error(err));</code></pre>
                </div>
                
                <h3>Load Model for Local Inference</h3>
                <div class="code-header">
                    <span>local_inference.py</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-block">
                    <pre><code class="language-python">import joblib
import numpy as np

# Load artifacts
model = joblib.load('model/model.pkl')
scaler = joblib.load('model/scaler.pkl')
label_encoders = joblib.load('model/label_encoders.pkl')
features = joblib.load('model/feature_list.pkl')

def predict(input_dict):
    """Make prediction without API"""
    # Encode categorical features
    for col in ['Crop', 'State', 'Irrigation_Type', 'Seed_Variety']:
        if col in input_dict:
            input_dict[f'{col}_Encoded'] = label_encoders[col].transform([input_dict[col]])[0]
    
    # Build feature vector
    X = np.array([[input_dict.get(f, 0) for f in features]])
    
    # Preprocess and predict
    X_scaled = scaler.transform(X)
    return max(0, model.predict(X_scaled)[0])

# Usage
result = predict({
    "Crop": "Rice", "State": "Punjab", "Year": 2024,
    "Rainfall_mm": 1200, "Temperature_C": 28,
    "Humidity": 70, "Soil_Quality": 75
})
print(f"Yield: {result:.2f} kg/ha")</code></pre>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Syntax highlighting
        hljs.highlightAll();
        
        // Copy code functionality
        function copyCode(btn) {
            const codeBlock = btn.closest('.code-header').nextElementSibling;
            const code = codeBlock.querySelector('code').innerText;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = btn.innerText;
                btn.innerText = 'Copied!';
                setTimeout(() => btn.innerText = originalText, 2000);
            });
        }
        
        // Smooth scrolling for sidebar links
        document.querySelectorAll('.sidebar-nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').slice(1);
                document.getElementById(targetId).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        
        // Highlight active section in sidebar
        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.sidebar-nav a');
        
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (scrollY >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.style.borderLeftColor = 'transparent';
                link.style.color = 'var(--text-secondary)';
                if (link.getAttribute('href').slice(1) === current) {
                    link.style.borderLeftColor = 'var(--primary-color)';
                    link.style.color = 'var(--primary-color)';
                }
            });
        });
    </script>
</body>
</html>
